<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Prompt Terapi BebasNyeri</title>
<meta name="theme-color" content="#b30000">

<style>
body { font-family: Arial; background:#f5f5f5; padding:15px; }
h2 { color:#b30000; }
label { font-weight:bold; display:block; margin-top:10px; }
input, textarea, select {
    width:100%; padding:8px; margin-top:4px;
    border-radius:6px; border:1px solid #ccc;
}
button {
    margin-top:15px; padding:10px;
    background:#b30000; color:white;
    border:none; border-radius:6px;
    font-weight:bold; cursor:pointer;
}
textarea { min-height:90px; }
.result-box {
    background:white; padding:10px;
    margin-top:15px; border-radius:6px;
    white-space:pre-wrap;
}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<h2>Form Konsultasi Terapi BebasNyeri</h2>

<label>Nama Pasien</label>
<input type="text" id="nama">

<label>Umur</label>
<input type="number" id="umur">

<label>Jenis Kelamin</label>
<select id="jk">
<option>Laki-laki</option>
<option>Perempuan</option>
</select>

<label>Keluhan Saat Ini</label>
<textarea id="keluhan"></textarea>

<label>Riwayat Penyakit</label>
<textarea id="penyakit"></textarea>

<label>Hasil Medis</label>
<textarea id="medis"></textarea>

<label><b>Hasil Saran Terapi dari AI</b></label>
<textarea id="hasilAI"></textarea>

<button onclick="buatPrompt()">Buat Prompt AI + Copy</button>
<button onclick="buatDanSharePDF()">Buat Laporan & Share ke WhatsApp</button>

<div class="result-box" id="hasil"></div>

<script>
function buatPrompt(){
let prompt = `Anda adalah asisten AI klinik terapi BebasNyeri.

Data Pasien:
Nama: ${nama.value}
Umur: ${umur.value}
Keluhan: ${keluhan.value}
Riwayat Penyakit: ${penyakit.value}
Hasil Medis: ${medis.value}

Berikan:
1. Ringkasan kondisi
2. Saran terapi pendamping
3. Makanan/minuman yang disarankan
4. Pantangan
5. Catatan keselamatan terapi`;

hasil.textContent = prompt;
navigator.clipboard.writeText(prompt);
alert("Prompt berhasil disalin!");
}

async function buatDanSharePDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const tanggal = new Date().toLocaleDateString("id-ID");

    doc.setFontSize(14);
    doc.text("Laporan Terapi Bebas Nyeri", 105, 15, null, null, "center");
    doc.setFontSize(10);
    doc.text("Jln. Cendana no. 3 Kisaran, Samping Bulog/Universitas Asahan.", 105, 21, null, null, "center");
    doc.text("Website: https://www.bebasnyeri.com", 105, 26, null, null, "center");
    doc.line(10, 35, 200, 35);

    doc.setFontSize(11);
    doc.text("Tanggal: " + tanggal, 10, 42);
    doc.text("Nama Pasien: " + nama.value, 10, 50);
    doc.text("Umur: " + umur.value + " tahun", 10, 56);
    doc.text("Jenis Kelamin: " + jk.value, 10, 62);

    let isi = `
Keluhan:
${keluhan.value}

Riwayat Penyakit:
${penyakit.value}

Hasil Medis:
${medis.value}

Saran Terapi & Pantangan:
${hasilAI.value}

Catatan:
Terapi bersifat pendamping dan tidak menggantikan diagnosis dokter.
`;

    let lines = doc.splitTextToSize(isi, 180);
    doc.text(lines, 10, 75);

    const pdfBlob = doc.output("blob");
    const file = new File([pdfBlob], "Laporan_Terapi_" + nama.value + ".pdf", { type: "application/pdf" });

    if (navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({
            title: "Laporan Terapi Bebas Nyeri",
            text: "Berikut laporan terapi Anda.",
            files: [file]
        });
    } else {
        // fallback kalau HP tidak support share file
        doc.save("Laporan_Terapi_" + nama.value + ".pdf");
        alert("HP tidak mendukung share langsung. File sudah di-download.");
    }
}
</script>

</body>
</html>
